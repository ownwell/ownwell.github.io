<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Activity生命周期和启动模式 | Cyning</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.0/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Activity生命周期和启动模式</h1><a id="logo" href="/.">Cyning</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Activity生命周期和启动模式</h1><div class="post-meta">Jun 1, 2016<span> | </span><span class="category"><a href="/categories/读书/">读书</a></span></div><div class="post-content"><div align="center">
<img src="http://7xj9f0.com1.z0.glb.clouddn.com/android-book.png" align="middle">
</div>

<p>《Android开发艺术探索》是一本很合适初高级工程师来学习和进阶，这种书多读读对自己也有成长。作者也是从自己的开发经验角度出发，似一位导师一样给我们讲解，我认为这本书对我真的有提高，从基础的Activity的生命周期到组件定制，再到四大组件的工作原理，很实用的技术。</p>
<a id="more"></a>

<h1 id="Activity的生命周期"><a href="#Activity的生命周期" class="headerlink" title="Activity的生命周期"></a>Activity的生命周期</h1><h2 id="1-1-Activity的生命周期"><a href="#1-1-Activity的生命周期" class="headerlink" title="1.1 Activity的生命周期"></a>1.1 Activity的生命周期</h2><ol>
<li><p><code>onCreate</code> <code>Activity</code> 创建时的初始化工作 如设置页面的ContentView、接收参数等.</p>
</li>
<li><p><code>onRestart</code> 在<code>Activity</code>的<code>onStop</code>后重新启动时，会调用这个参数</p>
</li>
<li><p><code>onStart</code>  正在启动，即将开始，没有出现在前台，还无法和用户交互，可以理解为已经初始化完成，但是处于后台我们暂时没法看见。</p>
</li>
<li><p><code>onResume</code>  可见了并且处于激活态,处于前台。</p>
<blockquote>
<p>和onStart最大的不同就是onStart是在后台已经初始化完，但是无法交互。</p>
</blockquote>
</li>
<li><p><code>onPause</code>  失去焦点不可以交互、处于后台。</p>
</li>
<li><p><code>onStop</code> 即将停止，做一些稍微重量级回收类的工作</p>
</li>
<li><p><code>onDestory</code> Activity即将被销毁，需要们做一些回收和资源释放类的工作。</p>
</li>
</ol>
<p>他们之间的关系：</p>
<p><img src="http://p.blog.csdn.net/images/p_blog_csdn_net/hpoi/EntryImages/20091003/347621596238419942633901667161718750.jpg" alt></p>
<p>或者同另外一个角度来看Activity生命周期之间的关系。<br><img src="http://7xj9f0.com1.z0.glb.clouddn.com/activity_life.png" alt></p>
<h2 id="异常的生命周期调用"><a href="#异常的生命周期调用" class="headerlink" title="异常的生命周期调用"></a>异常的生命周期调用</h2><p>其实我们开发中一般是按照这样的生命周期执行，但是也会有异常的一些处理，如系统内存不足时，会杀死一些进程，以回收一部分资源，来保证系统仍可以正常的运行。具体的例子可以参照：<a href="http://itindex.net/detail/50832-%E5%86%85%E5%AD%98-android-%E7%B3%BB%E7%BB%9F" target="_blank" rel="noopener">内存不足时Android 系统如何Kill进程</a>，kill进程的顺序：</p>
<p><strong>空进程— 后台进程 -&gt; 服务进程 -&gt; 可见进程 -&gt; 前台进程</strong></p>
<p>相对于异常Activity的生命周期过程实际上是精简版的完整生命周期，如我们按Home键，当前的进程(实际上已经成为了后台进程)可能会由于内存不足等其他原因，被系统的kill掉，此时执行时的是onPause–&gt;onStop 还有一个是为了保存activity数据状态的onSaveInstanceState,这些属于常见的内容，可以自行<a href="http://google.com" target="_blank" rel="noopener">搜索</a></p>
<h1 id="Activity的启动模式-LaunchMode"><a href="#Activity的启动模式-LaunchMode" class="headerlink" title="Activity的启动模式(LaunchMode)"></a>Activity的启动模式(LaunchMode)</h1><p>Activity的启动模式这个是我们做久项目，必须要思考和研究额内容，在很多时候，理解这些会事倍功倍。</p>
<p>Activity一共有四种启动方式：standard、SingleTask、SingleTop、SingleInstance。每次Activity启动都会加入加入任务栈，当销毁时又从任务栈中退出，任务栈是一个后进先出的栈结构，当任务栈中没有Activity时，系统会自动回收改任务栈。</p>
<p>在我们开发中，我们可能需要某一个Activity（如主界面的MainActivity）始终只有一个，没必要每次startActivity都新建一个吧。所以怎么区分这些驱动模式呢？</p>
<h2 id="Standard-标准模式"><a href="#Standard-标准模式" class="headerlink" title="Standard 标准模式"></a>Standard 标准模式</h2><blockquote>
<p>若没有给Activity设置启动模式，默认的设置就是标准模式。</p>
</blockquote>
<p>标准的Activity的启动方式，每次启动都会新建一个新的Activity，如Activity A(standart)对象启动Activity B（standard），就会执行标准的Activity的生命周期：</p>
<p> onPause –&gt; onStop –&gt;onCreate –&gt; onStart ……</p>
<p>这样任务栈中就有了A B(从栈低到栈顶的顺序)，当B在重新启动A时，就成了ABA。</p>
<p><img src="http://7xj9f0.com1.z0.glb.clouddn.com/launchmode1.png" alt="图 2-1"></p>
<blockquote>
<ol>
<li>默认的情况下，启动一个启动模式为standard的Activity启动另一个启动模式为standard的Activity，会将启动的Activity放入到前一个Activity的任务栈中，如图2-7 所示。</li>
<li>通过全局AppicationContext启动一个Activity，由于Application的context没有在任务栈，所以必须添加FLAG_ACITIVITY_NEW_TASK 这个标志位，来新建一个任务栈。</li>
</ol>
</blockquote>
<h2 id="SingleTop-栈顶复用模式。"><a href="#SingleTop-栈顶复用模式。" class="headerlink" title="SingleTop 栈顶复用模式。"></a>SingleTop 栈顶复用模式。</h2><p>该模式一个重要的特性是栈顶复用，当启动一个启动模式为SingleTop的Activity，会先去找这个Activity所在的任务栈的顶部是否已经存在，若栈顶有该Activity则会复用，不会重新新建Activity，而是复用该Activity，并调用该Activity的onNewIntent方法。</p>
<p><img src="http://7xj9f0.com1.z0.glb.clouddn.com/launchmode_singleTop.png" alt="图 2-2"></p>
<h2 id="SingleTask-栈内复用"><a href="#SingleTask-栈内复用" class="headerlink" title="SingleTask 栈内复用"></a>SingleTask 栈内复用</h2><p>SingleTask模式，是栈内的单例，当一个Acitiviy已经在栈内存在，多次启动这个Activity不会重新创建这个Activity实例，而是会直接调用这个栈内已经存在的该Activity实例，系统会调用这个Activity的onNewIntent，同时会清除栈内这个Activity到栈顶的所有Activity实例，实际上clearTop的效果。</p>
<p>如图2-2，只有3-2 可能会不一样，因为在B–&gt;A时，Acitivity A是在任务栈中的，会将Acitivity A调至栈顶，清除A到栈顶的所有Activity，最后就只有Activity A。</p>
</div><div class="tags"><a href="/tags/Android/">Android</a></div><div class="post-nav"><a class="pre" href="/2016/06/19/expand_touch/">扩大view的点击区域</a><a class="next" href="/2016/05/09/Android开发备忘/">Android开发备忘</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="http://ownwell.github.io"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kotlin/">Kotlin</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tools/">Tools</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据分析/">数据分析</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/生活/">生活</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/算法/">算法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/编程/">编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/读书/">读书</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Realm/" style="font-size: 15px;">Realm</a> <a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/Mac/" style="font-size: 15px;">Mac</a> <a href="/tags/CodeStyle/" style="font-size: 15px;">CodeStyle</a> <a href="/tags/IDEA/" style="font-size: 15px;">IDEA</a> <a href="/tags/Ruby/" style="font-size: 15px;">Ruby</a> <a href="/tags/Android源码/" style="font-size: 15px;">Android源码</a> <a href="/tags/Material/" style="font-size: 15px;">Material</a> <a href="/tags/Google/" style="font-size: 15px;">Google</a> <a href="/tags/抓包/" style="font-size: 15px;">抓包</a> <a href="/tags/Git/" style="font-size: 15px;">Git</a> <a href="/tags/Transition/" style="font-size: 15px;">Transition</a> <a href="/tags/Animations/" style="font-size: 15px;">Animations</a> <a href="/tags/翻译/" style="font-size: 15px;">翻译</a> <a href="/tags/Sublime-Text/" style="font-size: 15px;">Sublime Text</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/生活/" style="font-size: 15px;">生活</a> <a href="/tags/JavaEE/" style="font-size: 15px;">JavaEE</a> <a href="/tags/Tomcat/" style="font-size: 15px;">Tomcat</a> <a href="/tags/Jenkins/" style="font-size: 15px;">Jenkins</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/UI/" style="font-size: 15px;">UI</a> <a href="/tags/View/" style="font-size: 15px;">View</a> <a href="/tags/JCenter/" style="font-size: 15px;">JCenter</a> <a href="/tags/Tools/" style="font-size: 15px;">Tools</a> <a href="/tags/注解/" style="font-size: 15px;">注解</a> <a href="/tags/热修复/" style="font-size: 15px;">热修复</a> <a href="/tags/2018/" style="font-size: 15px;">2018</a> <a href="/tags/Kotlin/" style="font-size: 15px;">Kotlin</a> <a href="/tags/算法/" style="font-size: 15px;">算法</a> <a href="/tags/服务器/" style="font-size: 15px;">服务器</a> <a href="/tags/动态代理/" style="font-size: 15px;">动态代理</a> <a href="/tags/编程/" style="font-size: 15px;">编程</a> <a href="/tags/译文/" style="font-size: 15px;">译文</a> <a href="/tags/JNI开发/" style="font-size: 15px;">JNI开发</a> <a href="/tags/VS-code/" style="font-size: 15px;">VS code</a> <a href="/tags/Gradle/" style="font-size: 15px;">Gradle</a> <a href="/tags/AI/" style="font-size: 15px;">AI</a> <a href="/tags/pandas/" style="font-size: 15px;">pandas</a> <a href="/tags/设计模式/" style="font-size: 15px;">设计模式</a> <a href="/tags/单例/" style="font-size: 15px;">单例</a> <a href="/tags/多渠道/" style="font-size: 15px;">多渠道</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/hot-fix/" style="font-size: 15px;">hot-fix</a> <a href="/tags/Android热修复/" style="font-size: 15px;">Android热修复</a> <a href="/tags/Android进阶/" style="font-size: 15px;">Android进阶</a> <a href="/tags/Flutter/" style="font-size: 15px;">Flutter</a> <a href="/tags/插件化/" style="font-size: 15px;">插件化</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/07/12/插件化之Resource/">插件化之Resource</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/06/27/插件化之HookActivity/">插件化之Hook Activity</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/06/20/2019-06-20-alfred插件开发/">alfred插件开发-将github作为图床</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/12/Flutter-从一个demo开始/">Flutter 从一个demo开始</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/23/Aspect和aop打点调研/">Aspect和AOP打点调研</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/04/android-gradle-3/">Gradle插件开发(3) - 无侵入的函数运行时间统计的实现</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/20/android-gradle-2/">Gradle插件开发(2) - extensions和Task</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/17/conda-for-python2or3/">conda切换Python2和Python3环境</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/16/try-baidu-ai/">试了一把Baidu的语言处理sdk</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/16/good-tools-for-vs-code/">VS code的好用的插件和方便的配置</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://wanandroid.com/" title="wanAndroid" target="_blank">wanAndroid</a><ul></ul><a href="https://blog.csdn.net/luoshengyang" title="老罗" target="_blank">老罗</a><ul></ul><a href="http://androidxref.com/" title="androidxref" target="_blank">androidxref</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2019 <a href="/." rel="nofollow">Cyning.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>